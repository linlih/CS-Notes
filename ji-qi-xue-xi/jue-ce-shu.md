# 决策树

## 信息熵的定义

随机变量$$X$$的熵定义为：

$$
H(X) = - \sum^n_{i=1}{p_i\log{p_i}}
$$

怎么理解信息熵呢，通俗理解就是它是衡量混乱程度的一个指标。假设如果有两个变量，那么取这两个变量的概率都是0.5，那么此时的熵最大。就像你买东西的时候，有两个选择，概率都是0.5，就相当于你问你女朋友，然后她说随便，这个时候你就很无奈，不知道选哪个，纠结。那么如果其中一个概率为1，那么这个事情就是确定的，不存在什么混乱的情况，这个时候熵最小。

决策树就是一个信息熵下降的过程，从原本无法确定这个样本是什么，从树的根节点一直往下走，降低信息熵，也就是慢慢地明确了自己的选择，最终确定这个样本的类别或者是预测值。

## 信息增益

信息增益的定义为：

$$
g(D, A) = H(D) - H(D|A)
$$

单单看这个式子很抽象，我们举个实际的例子，这个例子要完成的任务给定申请人的特征信息，包括年龄，工作，房子以及信贷情况，给出是否同意申请人的贷款。具体的数据信息如下表：

| ID | 年龄 | 有工作 | 有自己的房子 | 信贷情况 | 类别 |
| :---: | :---: | :---: | :---: | :---: | :---: |
| 1 | 青年 | 否 | 否 | 一般 | 否 |
| 2 | 青年 | 否 | 否 | 好 | 否 |
| 3 | 青年 | 是 | 否 | 好 | 是 |
| 4 | 青年 | 是 | 是 | 一般 | 是 |
| 5 | 青年 | 否 | 否 | 一般 | 否 |
| 6 | 中年 | 否 | 否 | 一般 | 否 |
| 7 | 中年 | 否 | 否 | 好 | 否 |
| 8 | 中年 | 是 | 是 | 好 | 是 |
| 9 | 中年 | 否 | 是 | 非常好 | 是 |
| 10 | 中年 | 否 | 是 | 非常好 | 是 |
| 11 | 老年 | 否 | 是 | 非常好 | 是 |
| 12 | 老年 | 否 | 是 | 好 | 是 |
| 13 | 老年 | 是 | 否 | 好 | 是 |
| 14 | 老年 | 是 | 否 | 非常好 | 是 |
| 15 | 老年 | 否 | 否 | 一般 | 否 |

现在我们来看$$H(D)$$是怎么计算的，总共有15个样本，其中同意贷款申请的有9个样本，剩下的6个样本是不同意的，那么计算过程如下：

$$
H(D) = - \frac{9}{15}\log_2\frac{9}{15} - \frac{6}{15}\log_2\frac{6}{15} = 0.971
$$

接下来需要计算的是$$H(D|A_1)$$，其中$$A_1$$表示的是这里的特征，这里选择年龄，年龄共有三个取值，分别是青年、中年、老年，分别各有5个样本，分别记为$$D_1、D_2、D_3$$最终$$H(D|A_1)$$的结果如下：

$$
H(D|A_1) = \frac{5}{15}H(D_1) + \frac{5}{15}H(D_2) +\frac{5}{15}H(D_3)
$$

其中$$H(D_1)$$的计算如同我们计算$$H(D)$$是一致的，需要关注到在$$D_1$$这个类别的条件下贷款申请的同意情况，查看表格可以得到，在青年的类别中，共有2个同意申请，3个拒绝申请的，所以计算如下：

$$
H(D_1) = -\frac{2}{5}\log_2\frac{2}{5}-\frac{3}{5}\log_2\frac{3}{5}
$$

那么就可以按照这个方法依次算出$$H(D_2)$$和$$H(D_3)$$，最终我们就可以算出最后的$$H(D|A_1)$$，最终对于$$A_1$$特征，即给定年龄特征的条件下的信息增益为：

$$
\begin{align}
g(D, A_1) &= H(D) - \bigg[ \frac{5}{15}(-\frac{2}{5}\log_2\frac{2}{5}-\frac{3}{5}\log_2\frac{3}{5}) \\ &+ \frac{5}{15}(-\frac{3}{5}\log_2\frac{3}{5}-\frac{2}{5}\log_2\frac{2}{5}) 
\\&+ \frac{5}{15}(-\frac{4}{5}\log_2\frac{4}{5}-\frac{1}{5}\log_2\frac{1}{5}) 
 \bigg]
 \\ &= 0.971 - 0.888 = 0.083 
 \end{align}
$$

然后可以依次算出$$g(D, A_2)​$$ 、$$g(D, A_3)​$$以及$$g(D, A_4)​$$ ，就可以得到四个特征中选择信息增益最大的那个特征作为当前的根节点了。这里选择的就是$$A_3$$特征，即有自己的房子作为最优特征。

$$
g(D, A_1) = 0.083 \\g(D, A_2) = 0.324\\g(D, A_3) = 0.420\\g(D, A_4) = 0.363
$$



